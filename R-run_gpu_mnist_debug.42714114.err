Loading rhel8/default-amp
  Loading requirement: rhel8/slurm rhel8/global cuda/11.4
    libpciaccess/0.16/gcc-9.4.0-6fonbj6 libiconv/1.16/gcc-9.4.0-ahebbov
    libxml2/2.9.12/gcc-9.4.0-gnknt5e ncurses/6.2/gcc-9.4.0-aiirok7
    hwloc/2.5.0/gcc-9.4.0-7sqomga libevent/2.1.12/gcc-9.4.0-hgny7cm
    numactl/2.0.14/gcc-9.4.0-52dwc6n cuda/11.4.0/gcc-9.4.0-3hnxhjt
    gdrcopy/2.2/gcc-9.4.0-e4igtfp knem/1.1.4/gcc-9.4.0-bpbxgva
    libnl/3.3.0/gcc-9.4.0-whwhrwb rdma-core/34.0/gcc-9.4.0-5eo5n2u
    ucx/1.11.1/gcc-9.4.0-lktqyl4 openmpi/4.1.1/gcc-9.4.0-epagguv
/home/xty20/cem/venv/lib/python3.8/site-packages/setuptools/_distutils/cmd.py:66: SetuptoolsDeprecationWarning: setup.py install is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` directly.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
        ********************************************************************************

!!
  self.initialize_options()
/home/xty20/cem/venv/lib/python3.8/site-packages/setuptools/_distutils/cmd.py:66: EasyInstallDeprecationWarning: easy_install command is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` and ``easy_install``.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://github.com/pypa/setuptools/issues/917 for details.
        ********************************************************************************

!!
  self.initialize_options()
warning: build_py: byte-compiling is disabled, skipping.

warning: install_lib: byte-compiling is disabled, skipping.

zip_safe flag not set; analyzing archive contents...
2024-01-22 23:46:30.675809: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-22 23:46:33.745621: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO:root:Results will be dumped in results/mnist_add_test
DEBUG:root:And the dataset's root directory is /home/xty20/data
[rank: 0] Global seed set to 42
DEBUG:root:		Updated concept group map (with 8 groups):
DEBUG:root:			0 -> [0, 1, 2]
DEBUG:root:			1 -> [3, 4, 5]
DEBUG:root:			2 -> [6, 7, 8]
DEBUG:root:			5 -> [9, 10, 11, 12, 13]
DEBUG:root:			8 -> [14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
DEBUG:root:			9 -> [24, 25, 26, 27, 28, 29, 30, 31, 32, 33]
DEBUG:root:			10 -> [34, 35, 36, 37, 38, 39, 40, 41, 42, 43]
DEBUG:root:			11 -> [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]
/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/utilities/seed.py:47: LightningDeprecationWarning: `pytorch_lightning.utilities.seed.seed_everything` has been deprecated in v1.8.0 and will be removed in v2.0.0. Please use `lightning_fabric.utilities.seed.seed_everything` instead.
  rank_zero_deprecation(
[rank: 0] Global seed set to 42
INFO:root:Training sample shape is: torch.Size([2048, 12, 28, 28]) with type torch.FloatTensor
INFO:root:Training label shape is: torch.Size([2048]) with type torch.FloatTensor
INFO:root:	Number of output classes: 1
INFO:root:Training concept shape is: torch.Size([2048, 54]) with type torch.FloatTensor
INFO:root:	Number of training concepts: 54
INFO:root:Computing task class weights in the training dataset with size 1...
INFO:root:Setting log level to: "DEBUG"
WARNING:root:We will rerun model ConceptEmbeddingModel_split_0 as requested by the config
[rank: 0] Global seed set to 42
DEBUG:root:Restarting run because we could not find test_acc_c_ConceptEmbeddingModel in old results.
DEBUG:root:effective number of concepts is 8 and intervened groups are [0, 1, 2, 3, 4, 5, 6, 7, 8]used intervened groups are [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG:root:Restarting run because we could not find test_acc_y_group_optimal_global_no_prior_ints_ConceptEmbeddingModel in old results.
[rank: 0] Global seed set to 42
DEBUG:root:Intervention groups: [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG:root:Intervening with 0 out of 8 concept groups
DEBUG:root:	For split 0 with 0 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:	Test AUC when intervening with 0 concept groups is 50.05% (accuracy is 48.93%).
DEBUG:root:Intervening with 1 out of 8 concept groups
DEBUG:root:	For split 0 with 1 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 1 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 2 out of 8 concept groups
DEBUG:root:	For split 0 with 2 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 2 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 3 out of 8 concept groups
DEBUG:root:	For split 0 with 3 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 3 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 4 out of 8 concept groups
DEBUG:root:	For split 0 with 4 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 4 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 5 out of 8 concept groups
DEBUG:root:	For split 0 with 5 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 5 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 6 out of 8 concept groups
DEBUG:root:	For split 0 with 6 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 6 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 7 out of 8 concept groups
DEBUG:root:	For split 0 with 7 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 7 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:Intervening with 8 out of 8 concept groups
DEBUG:root:	For split 0 with 8 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.507728   0.50809187 0.5086006  ... 0.5091145  0.5100157  0.5072321 ]
 [0.5075469  0.50870895 0.5092108  ... 0.50908345 0.5101866  0.5083486 ]
 [0.50785136 0.5093478  0.5087556  ... 0.50934076 0.50952816 0.5087103 ]
 ...
 [0.49238628 0.49081796 0.4924161  ... 0.49189535 0.48976895 0.49146226]
 [0.50856376 0.50935906 0.5093895  ... 0.5093273  0.51018953 0.50756085]
 [0.5085468  0.5088577  0.50869775 ... 0.5092504  0.5086813  0.50861466]]
scores.shape: (2048, 8)


best_scores: [6 6 4 ... 2 6 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5076505  0.50922394 0.5086427  ... 0.50943637 0.5100442  0.5085918 ]
 [0.5084202  0.5087681  0.50923455 ... 0.5091377  0.50902927 0.5085155 ]
 [0.5085471  0.50811017 0.50864375 ... 0.5082152  0.509282   0.50758183]
 ...
 [0.50992835 0.5089755  0.5077975  ... 0.5080364  0.51003087 0.50865334]
 [0.4923216  0.4907352  0.49140197 ... 0.49104592 0.49139994 0.49250054]
 [0.50785947 0.508258   0.50783545 ... 0.5098016  0.51018286 0.5077719 ]]
scores.shape: (2048, 8)


best_scores: [4 4 6 ... 6 7 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.49017307 0.491847   0.49123436 ... 0.49034038 0.48965153 0.4918215 ]
 [0.50756127 0.50794315 0.50926113 ... 0.50907826 0.50980103 0.50803983]
 [0.50771856 0.5088875  0.50940144 ... 0.50904244 0.50926214 0.5076014 ]
 ...
 [0.49181432 0.4914212  0.49089676 ... 0.49131107 0.49169317 0.49270222]
 [0.5095641  0.5092008  0.50748825 ... 0.507848   0.5091613  0.50905997]
 [0.5082766  0.50860304 0.5091214  ... 0.5090673  0.509742   0.5069703 ]]
scores.shape: (2048, 8)


best_scores: [1 6 2 ... 7 4 6]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.4915339  0.4920105  0.4924321  ... 0.49045035 0.4901911  0.49196205]
 [0.4916775  0.49131942 0.49247664 ... 0.49089086 0.4900032  0.4926057 ]
 [0.5076442  0.5091651  0.50753266 ... 0.5088165  0.5099566  0.5085117 ]
 ...
 [0.4915596  0.49081686 0.4907313  ... 0.49085075 0.49026626 0.49253395]
 [0.50849867 0.50886035 0.5076784  ... 0.50793713 0.5092826  0.5075771 ]
 [0.5081996  0.5085671  0.50734234 ... 0.50901866 0.5090263  0.5073792 ]]
scores.shape: (2048, 8)


best_scores: [2 7 6 ... 7 4 4]
best_scores.shape: (2048,)



DEBUG:root:num_groups_intervened: 1



DEBUG:root:Printing info for optimal intervention policy:
intervened_concepts: [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33], [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], [44, 45, 46, 47, 48, 49, 50, 51, 52, 53]]


scores: [[0.5074595  0.50780714 0.5091236  ... 0.50915545 0.5084487  0.5073804 ]
 [0.5095221  0.5090078  0.5091399  ... 0.5089741  0.5096271  0.50730705]
 [0.5077734  0.5092424  0.50861686 ... 0.50920624 0.51006687 0.5085305 ]
 ...
 [0.5083647  0.50868917 0.5091884  ... 0.50791407 0.50924623 0.50735635]
 [0.4901929  0.49118322 0.4906041  ... 0.49101263 0.4905263  0.49243125]
 [0.4914695  0.49068892 0.49228424 ... 0.49098486 0.49053392 0.49235472]]
scores.shape: (1808, 8)


best_scores: [5 6 6 ... 4 7 7]
best_scores.shape: (1808,)



DEBUG:root:	Test AUC when intervening with 8 concept groups is 100.00% (accuracy is 48.93%).
DEBUG:root:		Test AUC when intervening with 0 concept groups is 50.05% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 1 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 2 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 3 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 4 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 5 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 6 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 7 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:		Test AUC when intervening with 8 concept groups is 100.00% (avg int time is 0.00052s and construction time is 0.00005s).
DEBUG:root:effective number of concepts is 8 and intervened groups are [0, 1, 2, 3, 4, 5, 6, 7, 8]used intervened groups are [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG:root:Restarting run because we could not find test_acc_y_group_optimal_global_fix_no_prior_ints_ConceptEmbeddingModel in old results.
[rank: 0] Global seed set to 42
DEBUG:root:Intervention groups: [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG:root:Intervening with 0 out of 8 concept groups
DEBUG:root:	For split 0 with 0 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:	Test AUC when intervening with 0 concept groups is 50.05% (accuracy is 48.93%).
DEBUG:root:Intervening with 1 out of 8 concept groups
DEBUG:root:	For split 0 with 1 groups intervened
DEBUG:root:Intervening on 10000 samples
DEBUG:root:num_groups_intervened: 1



Traceback (most recent call last):
  File "experiments/run_experiments_debug.py", line 828, in <module>
    main(
  File "experiments/run_experiments_debug.py", line 444, in main
    intervention_utils.test_interventions_debug(
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/interventions/utils.py", line 1486, in test_interventions_debug
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/train/utils.py", line 90, in load_call
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/interventions/utils.py", line 395, in intervene_in_cbm
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 892, in predict
    return call._call_and_handle_interrupt(
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 938, in _predict_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1190, in _run_stage
    return self._run_predict()
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1244, in _run_predict
    return self.predict_loop.run()
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/prediction_loop.py", line 100, in advance
    dl_predictions, dl_batch_indices = self.epoch_loop.run(
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/prediction_epoch_loop.py", line 100, in advance
    self._predict_step(batch, batch_idx, dataloader_idx)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/prediction_epoch_loop.py", line 129, in _predict_step
    predictions = self.trainer._call_strategy_hook("predict_step", *step_kwargs.values())
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 408, in predict_step
    return self.model.predict_step(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/models/cbm.py", line 611, in predict_step
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/models/cem.py", line 355, in _forward
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/interventions/optimal.py", line 375, in __call__
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/interventions/optimal.py", line 325, in _opt_score
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/interventions/optimal.py", line 269, in _importance_scores
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/models/cbm.py", line 592, in forward
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/models/cem.py", line 368, in _forward
  File "/home/xty20/cem/venv/lib/python3.8/site-packages/cem-1.1.0-py3.8.egg/cem/models/cbm.py", line 274, in _standardize_indices
ValueError: Unsupported intervention indices (0,)
srun: error: gpu-q-1: task 0: Exited with exit code 1
rm: cannot remove '/home/xty20/cem/hpc_*.ckpt': No such file or directory
